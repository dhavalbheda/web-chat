(this["webpackJsonpweb-chat"]=this["webpackJsonpweb-chat"]||[]).push([[0],{103:function(e,t,n){},104:function(e,t,n){"use strict";n.r(t);var a=n(3),c=n(55),r=n(56),s=n(63),i=n(62),o=n(2),l=n.n(o),u=n(29),d=n.n(u),j=(n(70),n(11)),m=n(25),b=n(10),f=(n(74),n(13)),h=n(107),O=n(58),p=n.n(O),g=n(59),v=n.n(g),x=(n(96),n(97),n(15)),N=n.n(x),y=n(22),w="CHAT_FETCH_REQUEST",E="CHAT_FETCH_SUCCESS",S="CHAT_FETCH_ERROR",T="CHAT_SET_ALERT",C="CHAT_REMOVE_ALERT",A="REQUEST_CONVERSATION",_="SET_CONVERSATION",U="UPDATE_CONVERSATION",F=n(43);F.a.initializeApp({apiKey:"AIzaSyB3mUGEeVTQn7hbmoxUNncowRjwD-5y2TI",authDomain:"digital-jalebi-ac363.firebaseapp.com",databaseURL:"https://digital-jalebi-ac363-default-rtdb.firebaseio.com",projectId:"digital-jalebi-ac363",storageBucket:"digital-jalebi-ac363.appspot.com",messagingSenderId:"105427663157",appId:"1:105427663157:web:3e564360c7852fb4abb47c",measurementId:"G-M2DJG8HX1P"});var R=F.a,k=R.firestore(),I=R.database(),P=R.firestore.FieldValue.arrayUnion,H=R.firestore.FieldValue.arrayRemove,L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return{type:A,payload:e}},D=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return{type:_,payload:e}},M=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return{type:U,payload:e}},V=function(){var e=Object(y.a)(N.a.mark((function e(t){var n,a,c,r,s,i=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.uuid,a=t.sender,c=t.receiver,r=t.message,s=i.length>1&&void 0!==i[1]?i[1]:0,I.ref().child(a+"-"+c).push().set({uuid:n,sender:a,receiver:c,message:r,isSeen:!1,createdAt:R.database.ServerValue.TIMESTAMP}),k.collection("users").doc(a).update({pendding:P(c)}),console.log(s);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),B=function(e){var t=e.friends,n=e.selectFriend,c=(e.uid,e.selectedFriend);return t.map((function(e,t){return Object(a.jsx)("li",{children:Object(a.jsxs)("div",{style:c.uid===e.uid?{background:"#b1b1b1"}:{},onClick:function(){return n(e)},children:[Object(a.jsx)("span",{className:"icon",children:Object(a.jsx)("img",{className:"icon",src:"https://i.pinimg.com/originals/86/63/78/866378ef5afbe8121b2bcd57aa4fb061.jpg",alt:""})}),Object(a.jsx)("span",{className:"title",children:e.firstName+" "+e.lastName})]},t)},t)}))},G=function(e){var t=e.conversation,n=e.selectedFriend,c=e.user,r=(e.totalUnseen,e.setTotalUnseen),s=0;return t.sort((function(e,t){return e.createdAt-t.createdAt})),t.map((function(e,t){var i=void 0;if(null!=e.createdAt){i=new Date(e.createdAt).toLocaleString("en",{day:"numeric",month:"short"}),i+=" "+new Date(e.createdAt).toLocaleTimeString([],{timeStyle:"short"})}return e.isSeen||s++,r(s),e.sender===n.uid&&e.receiver===c.uid||e.sender===c.uid&&e.receiver===n.uid?Object(a.jsx)(o.Fragment,{children:Object(a.jsx)("div",{style:{textAlign:e.sender===c.uid?"right":"left"},children:Object(a.jsxs)("p",{className:e.sender===c.uid?"messageStyle right-message":"messageStyle left-message",children:[e.message,Object(a.jsx)("br",{}),Object(a.jsx)("span",{className:"message-time",children:i||""}),e.receiver!==c.uid&&Object(a.jsx)("span",{className:"message-status",children:e.isSeen?Object(a.jsx)("i",{className:"far fa-eye"}):Object(a.jsx)("i",{className:"far fa-eye-slash"})})]})})},t):Object(a.jsx)(o.Fragment,{},t)}))},W=function(e){var t=Object(j.c)((function(e){return e.User})).user,n=Object(j.c)((function(e){return e.Chat})).conversation,c=Object(j.c)((function(e){return e.Chat})).friends,r=Object(o.useState)(!1),s=Object(f.a)(r,2),i=s[0],l=s[1],u=Object(o.useState)({}),d=Object(f.a)(u,2),m=d[0],b=d[1],O=Object(o.useState)(""),g=Object(f.a)(O,2),x=g[0],w=g[1],S=Object(o.useState)(!1),T=Object(f.a)(S,2),C=T[0],A=T[1],_=Object(o.useState)(0),U=Object(f.a)(_,2),F=U[0],R=U[1],P=Object(j.b)();Object(o.useEffect)((function(){var e;P((e=t.uid,function(){var t=Object(y.a)(N.a.mark((function t(n){var a;return N.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=k.collection("users").onSnapshot((function(t){var a=[];t.forEach((function(t){t.data().uid!==e&&a.push(t.data())})),n({type:E,payload:a})})),t.abrupt("return",a);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())).then((function(e){return e})).catch((function(e){return console.log(e)}))}),[]),Object(o.useEffect)((function(){return function(){return e=t.uid,n=m.uid,I.ref().child(e+"-"+n).off("child_added"),I.ref().child(e+"-"+n).off("child_changed"),void I.ref().child(n+"-"+e).off("child_added");var e,n}}),[m]);return Object(a.jsx)(o.Fragment,{children:Object(a.jsxs)("div",{className:"main-container",children:[Object(a.jsxs)("div",{className:"navigation",children:[Object(a.jsx)("div",{className:"bar-area",children:Object(a.jsx)("span",{className:"icon bar-icon",onClick:function(){var e=document.getElementsByClassName("navigation")[0];e.offsetWidth<300?e.style.width="300px":e.style.width="55px"},children:Object(a.jsx)("i",{className:"fas fa-bars"})})}),Object(a.jsx)("ul",{children:c.length>0&&Object(a.jsx)(B,{uid:t.uid,selectFriend:function(e){m&&m.uid===e.uid||(console.log(e.uid),l(!0),A(!1),w(""),b(e),P(function(e){var t=e.sender,n=e.receiver;return function(){var e=Object(y.a)(N.a.mark((function e(a){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a(L()),I.ref().child(t+"-"+n).on("child_added",(function(e){a(D(e.val()))})),I.ref().child(n+"-"+t).on("child_added",(function(e){e.val().isSeen||(I.ref().child(n+"-"+t).child(e.key).update({isSeen:!0}),k.collection("users").doc(n).update({pendding:H(t)})),a(D(e.val()))})),I.ref().child(t+"-"+n).on("child_changed",(function(e){a(M(e.val()))}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}({sender:t.uid,receiver:e.uid})))},friends:c,selectedFriend:m})})]}),Object(a.jsxs)("div",{className:"container-body",children:[Object(a.jsx)("div",{className:"friend-name",children:Object(a.jsx)("span",{children:i&&m.firstName+" "+m.lastName})}),Object(a.jsx)(p.a,{className:"message-section",children:i&&Object(a.jsx)(G,{conversation:n,selectedFriend:m,user:t,totalUnseen:F,setTotalUnseen:R})}),Object(a.jsxs)("div",{className:"chat-control",children:[Object(a.jsxs)("div",{className:"control",children:[Object(a.jsx)("textarea",{placeholder:"Enter Text...",value:x,onChange:function(e){w(e.target.value)}}),Object(a.jsx)("span",{className:"smile-icon",onClick:function(e){return A(!C)},children:Object(a.jsx)("i",{className:"fas fa-smile"})}),Object(a.jsx)("span",{className:"send-icon",onClick:function(){w("");var e={uuid:Object(h.a)(),sender:t.uid,receiver:m.uid,message:x};V(e,F)},children:Object(a.jsx)("i",{className:"fas fa-paper-plane"})})]}),C&&Object(a.jsx)(v.a,{onEmojiClick:function(e,t){var n=t.emoji;w(x+n)}})]})]})]})})},Q=n(5),z=n(64),J=function(e){var t=e.Component,n=e.path,c=Object(z.a)(e,["Component","path"]),r=Object(j.c)((function(e){return e.User})).authenticated;return Object(a.jsx)(o.Fragment,{children:r?Object(a.jsx)(b.b,Object(Q.a)(Object(Q.a)({exact:!0},c),{},{path:n,render:t})):Object(a.jsx)(b.a,{to:"/signin"})})},K=(n(102),n(103),"USER_FETCH_REQUEST"),Y="USER_FETCH_SUCCESS",Z="USER_FETCH_ERROR",q="USER_LOG_OUT",X="SET_ALERT",$="REMOVE_ALERT",ee="TAB_CHANGE",te=R.firestore(),ne=R.auth(),ae=function(){return{type:K,payload:null}},ce=function(e){return{type:Y,payload:e}},re=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return{type:Z,payload:e}},se=function(e){return{type:X,payload:e}},ie=function(e){return{type:$,payload:e}},oe=function(e,t){ne.createUserWithEmailAndPassword(e.email,e.password).then((function(n){le(n,e,t)})).catch((function(e){t(se({type:"danger",message:e.message})),setTimeout((function(){return t(ie())}),3e3)}))},le=function(e,t,n){var a=t.firstName,c=t.lastName,r=t.email;ne.currentUser.updateProfile({firstName:a,lastName:c}).then((function(){te.collection("users").doc(e.user.uid).set({firstName:a,lastName:c,email:r,uid:e.user.uid,isActive:!0,createdAt:new Date}).then((function(){localStorage.setItem("userId",e.user.uid),n(ce({firstName:a,lastName:c,email:r,uid:e.user.uid})),n(se({type:"success",message:"User Registerd Successfull"})),setTimeout((function(){return n(ie())}),3e3)}))})).catch((function(e){n(se({type:"danger",message:e.message})),setTimeout((function(){return n(ie())}),3e3)}))},ue=function(e){var t=e.alert;return Object(a.jsx)(o.Fragment,{children:Object(a.jsx)("div",{className:"alert alert-".concat(t.type," alert-dismissible fade show mt-3"),style:{zIndex:1},role:"alert",children:Object(a.jsxs)("strong",{children:[t.message," !"]})})})},de=function(){var e=Object(j.c)((function(e){return e.User})),t=e.userAlert,n=e.authenticated,c=Object(o.useState)(""),r=Object(f.a)(c,2),s=r[0],i=r[1],l=Object(o.useState)(""),u=Object(f.a)(l,2),d=u[0],h=u[1],O=Object(j.b)(),p=function(e){var t;e.preventDefault(),O((t={email:s,password:d},function(){var e=Object(y.a)(N.a.mark((function e(n){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:""===t.email||t.password<6?(n(se({type:"warning",message:"Email is required!\n Password Must be more than 6 letter"})),setTimeout((function(){return n(ie())}),3e3)):(n(ae()),ne.signInWithEmailAndPassword(t.email,t.password).then((function(e){te.collection("users").doc(e.user.uid).update({isActive:!0}).then((function(){localStorage.setItem("userId",e.user.uid),n(se({type:"success",message:"Sign In Successfully"})),setTimeout((function(){return n(ie())}),3e3)})).catch((function(e){n(se({type:"danger",message:e.message})),setTimeout((function(){return n(ie())}),3e3)}))})).catch((function(e){n(se({type:"danger",message:e.message})),setTimeout((function(){return n(ie())}),3e3)})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()))};return Object(a.jsxs)("div",{className:"container",children:[t&&Object(a.jsx)(ue,{alert:t}),n&&Object(a.jsx)(b.a,{to:"/"}),Object(a.jsx)("div",{className:"row justify-content-center justify-content-md-start",children:Object(a.jsx)("div",{className:"col-10 col-md-4 login-form ml-md-5 align-self-center",children:Object(a.jsxs)("form",{children:[Object(a.jsx)("div",{className:"form-group row",children:Object(a.jsx)("img",{alt:"signin",src:"https://media.giphy.com/media/kcZlnhiaB1p76tKS6S/giphy.gif"})}),Object(a.jsx)("div",{className:"form-group row",children:Object(a.jsx)("label",{htmlFor:"staticEmail",className:"col-sm-2 col-form-label align-self-start ml-md-5",children:"Email"})}),Object(a.jsx)("div",{className:"form-group row justify-content-center mb-4",children:Object(a.jsxs)("div",{className:"col-sm-10",children:[Object(a.jsx)("input",{type:"text",className:"form-control",id:"staticEmail",placeholder:"email@example.com",value:s,onChange:function(e){return i(e.target.value)}}),";"]})}),Object(a.jsx)("div",{className:"form-group row",children:Object(a.jsx)("label",{htmlFor:"inputPassword",className:"col-sm-2 col-form-label ml-md-5",children:"Password"})}),Object(a.jsx)("div",{className:"form-group row justify-content-center mb-4",children:Object(a.jsx)("div",{className:"col-sm-10",children:Object(a.jsx)("input",{type:"password",className:"form-control",id:"inputPassword",placeholder:"Password",value:d,onChange:function(e){return h(e.target.value)}})})}),Object(a.jsxs)("div",{className:"form-group row justify-content-center",children:[Object(a.jsx)("button",{className:"btn btn-primary m-2",onClick:function(e){return p(e)},children:"Sign In"}),Object(a.jsx)(m.b,{to:"/signup",className:"btn btn-primary m-2",children:"Sign Up"})]})]})})})]})},je=function(){var e=Object(j.c)((function(e){return e.User})),t=e.userAlert,n=e.authenticated,c=Object(o.useState)(""),r=Object(f.a)(c,2),s=r[0],i=r[1],l=Object(o.useState)(""),u=Object(f.a)(l,2),d=u[0],h=u[1],O=Object(o.useState)(""),p=Object(f.a)(O,2),g=p[0],v=p[1],x=Object(o.useState)(""),N=Object(f.a)(x,2),y=N[0],w=N[1],E=Object(o.useState)(""),S=Object(f.a)(E,2),T=S[0],C=S[1],A=Object(j.b)(),_=function(e){e.preventDefault(),A(function(e,t){return function(n){e.password!==t?(n(se({type:"danger",message:"Password and Confirm Password does not match"})),setTimeout((function(){return n(ie())}),3e3)):(n(ae()),oe(e,n))}}({firstName:s,lastName:d,email:g,password:y},T))};return Object(a.jsxs)("div",{className:"container",children:[n&&Object(a.jsx)(b.a,{to:"/"}),t&&Object(a.jsx)(ue,{alert:t}),Object(a.jsx)("div",{className:"row justify-content-center justify-content-md-start",children:Object(a.jsx)("div",{className:"col-10 col-md-4 login-form ml-md-5 align-self-center",children:Object(a.jsxs)("form",{children:[Object(a.jsx)("div",{className:"form-group row",children:Object(a.jsx)("img",{alt:"signin",src:"https://media.giphy.com/media/kcZlnhiaB1p76tKS6S/giphy.gif"})}),Object(a.jsx)("div",{className:"form-group row",children:Object(a.jsx)("label",{htmlFor:"staticEmail",className:"col col-form-label align-self-start ml-md-5",children:"First Name"})}),Object(a.jsx)("div",{className:"form-group row justify-content-center mb-4",children:Object(a.jsx)("div",{className:"col-sm-10",children:Object(a.jsx)("input",{type:"text",className:"form-control",placeholder:"Enter First Name",value:s,onChange:function(e){return i(e.target.value)}})})}),Object(a.jsx)("div",{className:"form-group row",children:Object(a.jsx)("label",{htmlFor:"staticEmail",className:"col col-form-label align-self-start ml-md-5",children:"Last Name"})}),Object(a.jsx)("div",{className:"form-group row justify-content-center mb-4",children:Object(a.jsx)("div",{className:"col-sm-10",children:Object(a.jsx)("input",{type:"text",className:"form-control",placeholder:"Enter Last Name",value:d,onChange:function(e){return h(e.target.value)}})})}),Object(a.jsx)("div",{className:"form-group row",children:Object(a.jsx)("label",{htmlFor:"staticEmail",className:"col col-form-label align-self-start ml-md-5",children:"Email"})}),Object(a.jsx)("div",{className:"form-group row justify-content-center mb-4",children:Object(a.jsx)("div",{className:"col-sm-10",children:Object(a.jsx)("input",{type:"text",className:"form-control",placeholder:"Enter Email Id",value:g,onChange:function(e){return v(e.target.value)}})})}),Object(a.jsx)("div",{className:"form-group row",children:Object(a.jsx)("label",{htmlFor:"inputPassword",className:"col col-form-label ml-md-5",children:"Password"})}),Object(a.jsx)("div",{className:"form-group row justify-content-center mb-4",children:Object(a.jsx)("div",{className:"col-sm-10",children:Object(a.jsx)("input",{type:"password",className:"form-control",placeholder:"Enter Password",value:y,onChange:function(e){return w(e.target.value)}})})}),Object(a.jsx)("div",{className:"form-group row",children:Object(a.jsx)("label",{htmlFor:"inputPassword",className:"col col-form-label ml-md-5",children:"Confirm Password"})}),Object(a.jsx)("div",{className:"form-group row justify-content-center mb-4",children:Object(a.jsx)("div",{className:"col-sm-10",children:Object(a.jsx)("input",{type:"password",className:"form-control",placeholder:"Enter Confirm Password",value:T,onChange:function(e){return C(e.target.value)}})})}),Object(a.jsxs)("div",{className:"form-group row justify-content-center",children:[Object(a.jsx)("button",{className:"btn btn-primary m-2",onClick:function(e){return _(e)},children:"Sign Up"}),Object(a.jsx)(m.b,{to:"/signin",className:"btn btn-primary m-2",children:"I Have Account"})]})]})})})]})},me=function(){var e=Object(j.b)();return Object(o.useEffect)((function(){e((function(e){ne.onAuthStateChanged(function(){var t=Object(y.a)(N.a.mark((function t(n){var a,c,r,s,i,o,l;return N.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=8;break}return a=R.firestore().collection("users").doc(n.uid),t.next=4,a.get();case 4:(c=t.sent).exists?(r=c.data(),s=r.firstName,i=r.lastName,o=r.email,l=r.uid,e(ce({firstName:s,lastName:i,email:o,uid:l}))):(e(se({type:"danger",message:"Your Account Terminated, So Please Register With New Email.."})),setTimeout((function(){return e(ie())}),3e3),e(re(""))),t.next=11;break;case 8:e(se({type:"warning",message:"You Logged Out Please Login"})),setTimeout((function(){return e(ie())}),3e3),e(re(""));case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}))}),[e]),Object(a.jsx)("div",{className:"App",style:{height:"100%"},children:Object(a.jsxs)(m.a,{children:[Object(a.jsx)(b.b,{path:"/signin",component:de}),Object(a.jsx)(b.b,{path:"/signup",component:je}),Object(a.jsx)(J,{exact:!0,path:"/",component:W})]})})},be=n(21),fe=n(60),he=n(61),Oe={user:{},authenticated:!1,currentTab:null,loadding:!1,userAlert:null},pe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Oe,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case K:return Object(Q.a)(Object(Q.a)({},e),{},{loadding:!0});case Y:return Object(Q.a)(Object(Q.a)({},e),{},{user:a,loadding:!1,authenticated:!0});case Z:case q:return Object(Q.a)(Object(Q.a)({},e),{},{user:{},loadding:!1,authenticated:!1});case ee:return Object(Q.a)(Object(Q.a)({},e),{},{currentTab:a});case X:return Object(Q.a)(Object(Q.a)({},e),{},{userAlert:a});case $:return Object(Q.a)(Object(Q.a)({},e),{},{userAlert:null});default:return e}},ge=n(44),ve={friends:[],conversation:[],loadding:!1,chatAlert:null},xe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ve,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case w:return Object(Q.a)(Object(Q.a)({},e),{},{loadding:!0});case E:return Object(Q.a)(Object(Q.a)({},e),{},{friends:a,loadding:!1});case S:return Object(Q.a)(Object(Q.a)({},e),{},{friends:[],loadding:!1});case A:return Object(Q.a)(Object(Q.a)({},e),{},{loadding:!0,conversation:[]});case _:return Object(Q.a)(Object(Q.a)({},e),{},{conversation:[].concat(Object(ge.a)(e.conversation),[a]),loadding:!1});case U:var c=e.conversation.filter((function(e){return e.uuid!==a.uuid}));return Object(Q.a)(Object(Q.a)({},e),{},{conversation:[].concat(Object(ge.a)(c),[a]),loadding:!1});case T:return Object(Q.a)(Object(Q.a)({},e),{},{chatAlert:a});case C:return Object(Q.a)(Object(Q.a)({},e),{},{chatAlert:null});default:return e}},Ne=Object(be.combineReducers)({User:pe,Chat:xe}),ye=Object(be.createStore)(Ne,Object(fe.composeWithDevTools)(Object(be.applyMiddleware)(he.a))),we=function(e){Object(s.a)(n,e);var t=Object(i.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"componentDidMount",value:function(){window.addEventListener("beforeunload",(function(){return"show warning"}))}},{key:"render",value:function(){return Object(a.jsx)("div",{})}}]),n}(o.Component);d.a.render(Object(a.jsx)(l.a.StrictMode,{children:Object(a.jsxs)(j.a,{store:ye,children:[Object(a.jsx)(me,{}),Object(a.jsx)(we,{})]})}),document.getElementById("root"))},70:function(e,t,n){},74:function(e,t,n){},96:function(e,t,n){},97:function(e,t,n){}},[[104,1,2]]]);
//# sourceMappingURL=main.21fd489f.chunk.js.map