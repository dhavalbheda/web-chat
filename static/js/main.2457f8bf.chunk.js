(this["webpackJsonpweb-chat"]=this["webpackJsonpweb-chat"]||[]).push([[0],{45:function(e,t,n){},49:function(e,t,n){},53:function(e,t,n){},55:function(e,t,n){},57:function(e,t,n){},58:function(e,t,n){"use strict";n.r(t);var c=n(3),a=n(2),r=n.n(a),s=n(26),i=n.n(s),o=(n(45),n(11)),l=n(19),u=n(10),d=(n(49),n(16)),m=n(17),j=n.n(m),f=n(22),b="CHAT_FETCH_REQUEST",h="CHAT_FETCH_SUCCESS",p="CHAT_FETCH_ERROR",O="CHAT_SET_ALERT",g="CHAT_REMOVE_ALERT",v="SET_CONVERSATION",x="REQUEST_CONVERSATION",N=n(33);N.a.initializeApp({apiKey:"AIzaSyB3mUGEeVTQn7hbmoxUNncowRjwD-5y2TI",authDomain:"digital-jalebi-ac363.firebaseapp.com",projectId:"digital-jalebi-ac363",storageBucket:"digital-jalebi-ac363.appspot.com",messagingSenderId:"105427663157",appId:"1:105427663157:web:3e564360c7852fb4abb47c",measurementId:"G-M2DJG8HX1P"});var y=N.a,w=y.firestore(),E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return{type:x,payload:e}},S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return{type:v,payload:e}},T=function(e){var t=e.sender,n=e.receiver;return function(){var e=Object(f.a)(j.a.mark((function e(c){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log(n),c(E()),w.collection("conversation").where("sender","in",[t,n]).orderBy("createdAt","asc").onSnapshot((function(e){var a=[];e.forEach((function(e){(e.data().sender===t&&e.data().receiver===n||e.data().sender===n&&e.data().receiver===t)&&a.push(e.data())})),c(S(a))}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},C=(n(53),"USER_FETCH_REQUEST"),A="USER_FETCH_SUCCESS",R="USER_FETCH_ERROR",U="USER_LOG_OUT",F="SET_ALERT",_="REMOVE_ALERT",I=y.firestore(),P=y.auth(),k=function(){return{type:C,payload:null}},H=function(e){return{type:A,payload:e}},L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return{type:R,payload:e}},D=function(e){return{type:F,payload:e}},B=function(e){return{type:_,payload:e}},M=function(e,t){P.createUserWithEmailAndPassword(e.email,e.password).then((function(n){W(n,e,t)})).catch((function(e){t(D({type:"danger",message:e.message})),setTimeout((function(){return t(B())}),3e3)}))},W=function(e,t,n){var c=t.firstName,a=t.lastName,r=t.email;P.currentUser.updateProfile({firstName:c,lastName:a}).then((function(){I.collection("users").doc(e.user.uid).set({firstName:c,lastName:a,email:r,uid:e.user.uid,isActive:!0,createdAt:new Date}).then((function(){localStorage.setItem("userId",e.user.uid),n(H({firstName:c,lastName:a,email:r,uid:e.user.uid})),n(D({type:"success",message:"User Registerd Successfull"})),setTimeout((function(){return n(B())}),3e3)}))})).catch((function(e){n(D({type:"danger",message:e.message})),setTimeout((function(){return n(B())}),3e3)}))},V=function(e){return function(t){t(k()),I.collection("users").doc(e).update({isActive:!1}).then((function(){P.signOut().then((function(){t({type:U,payload:null}),t(D({type:"success",message:"Logout Successfully"})),setTimeout((function(){return t(B())}),3e3)})).catch((function(e){t(D({type:"danger",message:e.message})),setTimeout((function(){return t(B())}),3e3)}))})).catch((function(e){t(D({type:"danger",message:e.message})),setTimeout((function(){return t(B())}),3e3)}))}},G=function(e){var t=Object(o.c)((function(e){return e.User})).user,n=Object(o.b)();return Object(c.jsxs)("header",{className:"header",children:[Object(c.jsx)("div",{style:{display:"flex"},children:Object(c.jsx)("div",{className:"logo",children:"Digital Jalebi"})}),Object(c.jsx)("div",{style:{margin:"20px 0px",color:"#fff",fontWeight:"bold"},children:"I'm "+t.firstName+" "+t.lastName}),Object(c.jsx)("ul",{className:"menu",children:Object(c.jsx)("li",{children:Object(c.jsx)(l.b,{to:"/signin",onClick:function(){n(V(t.uid))},children:"LogOut"})})})]})},J=(n(55),function(e){var t=e.friends,n=e.selectFriend;return t.map((function(e,t){return Object(c.jsxs)("div",{className:"displayName",onClick:function(){return n(e)},children:[Object(c.jsx)("div",{className:"displayPic",children:Object(c.jsx)("img",{src:"https://i.pinimg.com/originals/86/63/78/866378ef5afbe8121b2bcd57aa4fb061.jpg",alt:""})}),Object(c.jsxs)("div",{style:{display:"flex",flex:1,justifyContent:"space-between",margin:"0 10px"},children:[Object(c.jsx)("span",{style:{fontWeight:500},children:e.firstName+" "+e.lastName}),Object(c.jsx)("span",{children:e.isActive?"Active":"offline"})]})]},t)}))}),Q=function(e){var t,n=Object(o.c)((function(e){return e.User})).user,r=Object(o.c)((function(e){return e.Chat})).conversation,s=Object(o.c)((function(e){return e.Chat})).friends,i=Object(a.useState)(!1),l=Object(d.a)(i,2),u=l[0],m=l[1],b=Object(a.useState)({}),p=Object(d.a)(b,2),O=p[0],g=p[1],v=Object(a.useState)(""),x=Object(d.a)(v,2),N=x[0],y=x[1],E=Object(o.b)();Object(a.useEffect)((function(){var e;t=E((e=n.uid,function(){var t=Object(f.a)(j.a.mark((function t(n){var c;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=w.collection("users").onSnapshot((function(t){var c=[];t.forEach((function(t){t.data().uid!==e&&c.push(t.data())})),n({type:h,payload:c})})),t.abrupt("return",c);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())).then((function(e){return e})).catch((function(e){return console.log(e)}))}),[]),Object(a.useEffect)((function(){return function(){return t.then((function(e){return e()})).catch((function(e){return console.log(e)}))}}),[]);return Object(c.jsxs)(a.Fragment,{children:[Object(c.jsx)(G,{}),Object(c.jsxs)("section",{className:"container-body",children:[Object(c.jsx)("div",{className:"listOfUsers",children:s.length>0&&Object(c.jsx)(J,{selectFriend:function(e){m(!0),g(e),E(T({sender:n.uid,receiver:e.uid}))},friends:s})}),Object(c.jsxs)("div",{className:"chatArea",children:[Object(c.jsx)("div",{className:"chatHeader",children:u&&O.firstName+" "+O.lastName}),Object(c.jsx)("div",{className:"messageSections",children:u&&r.map((function(e,t){return e.sender===O.uid&&e.receiver===n.uid||e.sender===n.uid&&e.receiver===O.uid?Object(c.jsx)("div",{style:{textAlign:e.sender===n.uid?"right":"left"},children:Object(c.jsx)("p",{className:e.sender===n.uid?"messageStyle right-message":"messageStyle left-message",children:e.message})},t):Object(c.jsx)(a.Fragment,{},t)}))}),Object(c.jsx)("div",{className:"chatControls",children:u&&Object(c.jsxs)(a.Fragment,{children:[Object(c.jsx)("textarea",{placeholder:"Enter Text...",value:N,onChange:function(e){return y(e.target.value)}}),Object(c.jsx)("button",{onClick:function(){y("");var e={sender:n.uid,receiver:O.uid,message:N};E(function(e){var t=e.sender,n=e.receiver,c=e.message;return function(){var e=Object(f.a)(j.a.mark((function e(a){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:w.collection("conversation").add({sender:t,receiver:n,message:c,isSeen:!1,createdAt:new Date}).then((function(e){console.log(e)})).catch((function(e){return console.log(e)}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}(e)),E(T({sender:n.uid,receiver:O.uid}))},children:"Send"})]})})]})]})]})},z=n(5),K=n(39),Y=function(e){var t=e.Component,n=e.path,r=Object(K.a)(e,["Component","path"]),s=Object(o.c)((function(e){return e.User})).authenticated;return Object(c.jsx)(a.Fragment,{children:s?Object(c.jsx)(u.b,Object(z.a)(Object(z.a)({exact:!0},r),{},{path:n,render:t})):Object(c.jsx)(u.a,{to:"/signin"})})},Z=(n(56),n(57),function(e){var t=e.alert;return Object(c.jsx)(a.Fragment,{children:Object(c.jsx)("div",{className:"alert alert-".concat(t.type," alert-dismissible fade show mt-3"),style:{zIndex:1},role:"alert",children:Object(c.jsxs)("strong",{children:[t.message," !"]})})})}),q=function(){var e=Object(o.c)((function(e){return e.User})),t=e.userAlert,n=e.authenticated,r=Object(a.useState)(""),s=Object(d.a)(r,2),i=s[0],m=s[1],b=Object(a.useState)(""),h=Object(d.a)(b,2),p=h[0],O=h[1],g=Object(o.b)(),v=function(e){var t;e.preventDefault(),g((t={email:i,password:p},function(){var e=Object(f.a)(j.a.mark((function e(n){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:""===t.email||t.password<6?(n(D({type:"warning",message:"Email is required!\n Password Must be more than 6 letter"})),setTimeout((function(){return n(B())}),3e3)):(n(k()),P.signInWithEmailAndPassword(t.email,t.password).then((function(e){I.collection("users").doc(e.user.uid).update({isActive:!0}).then((function(){localStorage.setItem("userId",e.user.uid),n(D({type:"success",message:"Sign In Successfully"})),setTimeout((function(){return n(B())}),3e3)})).catch((function(e){n(D({type:"danger",message:e.message})),setTimeout((function(){return n(B())}),3e3)}))})).catch((function(e){n(D({type:"danger",message:e.message})),setTimeout((function(){return n(B())}),3e3)})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()))};return Object(c.jsxs)("div",{className:"container",children:[t&&Object(c.jsx)(Z,{alert:t}),n&&Object(c.jsx)(u.a,{to:"/"}),Object(c.jsx)("div",{className:"row justify-content-center justify-content-md-start",children:Object(c.jsx)("div",{className:"col-10 col-md-4 login-form ml-md-5 align-self-center",children:Object(c.jsxs)("form",{children:[Object(c.jsx)("div",{className:"form-group row",children:Object(c.jsx)("img",{alt:"signin",src:"https://media.giphy.com/media/kcZlnhiaB1p76tKS6S/giphy.gif"})}),Object(c.jsx)("div",{className:"form-group row",children:Object(c.jsx)("label",{htmlFor:"staticEmail",className:"col-sm-2 col-form-label align-self-start ml-md-5",children:"Email"})}),Object(c.jsx)("div",{className:"form-group row justify-content-center mb-4",children:Object(c.jsxs)("div",{className:"col-sm-10",children:[Object(c.jsx)("input",{type:"text",className:"form-control",id:"staticEmail",placeholder:"email@example.com",value:i,onChange:function(e){return m(e.target.value)}}),";"]})}),Object(c.jsx)("div",{className:"form-group row",children:Object(c.jsx)("label",{htmlFor:"inputPassword",className:"col-sm-2 col-form-label ml-md-5",children:"Password"})}),Object(c.jsx)("div",{className:"form-group row justify-content-center mb-4",children:Object(c.jsx)("div",{className:"col-sm-10",children:Object(c.jsx)("input",{type:"password",className:"form-control",id:"inputPassword",placeholder:"Password",value:p,onChange:function(e){return O(e.target.value)}})})}),Object(c.jsxs)("div",{className:"form-group row justify-content-center",children:[Object(c.jsx)("button",{className:"btn btn-primary m-2",onClick:function(e){return v(e)},children:"Sign In"}),Object(c.jsx)(l.c,{to:"/signup",className:"btn btn-primary m-2",children:"Sign Up"})]})]})})})]})},X=function(){var e=Object(o.c)((function(e){return e.User})).userAlert,t=Object(a.useState)(""),n=Object(d.a)(t,2),r=n[0],s=n[1],i=Object(a.useState)(""),u=Object(d.a)(i,2),m=u[0],j=u[1],f=Object(a.useState)(""),b=Object(d.a)(f,2),h=b[0],p=b[1],O=Object(a.useState)(""),g=Object(d.a)(O,2),v=g[0],x=g[1],N=Object(a.useState)(""),y=Object(d.a)(N,2),w=y[0],E=y[1],S=Object(o.b)(),T=function(e){e.preventDefault(),S(function(e,t){return function(n){e.password!==t?(n(D({type:"danger",message:"Password and Confirm Password does not match"})),setTimeout((function(){return n(B())}),3e3)):(n(k()),M(e,n))}}({firstName:r,lastName:m,email:h,password:v},w))};return Object(c.jsxs)("div",{className:"container",children:[e&&Object(c.jsx)(Z,{alert:e}),Object(c.jsx)("div",{className:"row justify-content-center justify-content-md-start",children:Object(c.jsx)("div",{className:"col-10 col-md-4 login-form ml-md-5 align-self-center",children:Object(c.jsxs)("form",{children:[Object(c.jsx)("div",{className:"form-group row",children:Object(c.jsx)("img",{alt:"signin",src:"https://media.giphy.com/media/kcZlnhiaB1p76tKS6S/giphy.gif"})}),Object(c.jsx)("div",{className:"form-group row",children:Object(c.jsx)("label",{htmlFor:"staticEmail",className:"col col-form-label align-self-start ml-md-5",children:"First Name"})}),Object(c.jsx)("div",{className:"form-group row justify-content-center mb-4",children:Object(c.jsx)("div",{className:"col-sm-10",children:Object(c.jsx)("input",{type:"text",className:"form-control",placeholder:"Enter First Name",value:r,onChange:function(e){return s(e.target.value)}})})}),Object(c.jsx)("div",{className:"form-group row",children:Object(c.jsx)("label",{htmlFor:"staticEmail",className:"col col-form-label align-self-start ml-md-5",children:"Last Name"})}),Object(c.jsx)("div",{className:"form-group row justify-content-center mb-4",children:Object(c.jsx)("div",{className:"col-sm-10",children:Object(c.jsx)("input",{type:"text",className:"form-control",placeholder:"Enter Last Name",value:m,onChange:function(e){return j(e.target.value)}})})}),Object(c.jsx)("div",{className:"form-group row",children:Object(c.jsx)("label",{htmlFor:"staticEmail",className:"col col-form-label align-self-start ml-md-5",children:"Email"})}),Object(c.jsx)("div",{className:"form-group row justify-content-center mb-4",children:Object(c.jsx)("div",{className:"col-sm-10",children:Object(c.jsx)("input",{type:"text",className:"form-control",placeholder:"Enter Email Id",value:h,onChange:function(e){return p(e.target.value)}})})}),Object(c.jsx)("div",{className:"form-group row",children:Object(c.jsx)("label",{htmlFor:"inputPassword",className:"col col-form-label ml-md-5",children:"Password"})}),Object(c.jsx)("div",{className:"form-group row justify-content-center mb-4",children:Object(c.jsx)("div",{className:"col-sm-10",children:Object(c.jsx)("input",{type:"password",className:"form-control",placeholder:"Enter Password",value:v,onChange:function(e){return x(e.target.value)}})})}),Object(c.jsx)("div",{className:"form-group row",children:Object(c.jsx)("label",{htmlFor:"inputPassword",className:"col col-form-label ml-md-5",children:"Confirm Password"})}),Object(c.jsx)("div",{className:"form-group row justify-content-center mb-4",children:Object(c.jsx)("div",{className:"col-sm-10",children:Object(c.jsx)("input",{type:"password",className:"form-control",placeholder:"Enter Confirm Password",value:w,onChange:function(e){return E(e.target.value)}})})}),Object(c.jsxs)("div",{className:"form-group row justify-content-center",children:[Object(c.jsx)("button",{className:"btn btn-primary m-2",onClick:function(e){return T(e)},children:"Sign Up"}),Object(c.jsx)(l.c,{to:"/signin",className:"btn btn-primary m-2",children:"I Have Account"})]})]})})})]})},$=function(){var e=Object(o.b)();return Object(a.useEffect)((function(){e((function(e){P.onAuthStateChanged(function(){var t=Object(f.a)(j.a.mark((function t(n){var c,a,r,s,i,o,l;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=8;break}return c=y.firestore().collection("users").doc(n.uid),t.next=4,c.get();case 4:(a=t.sent).exists?(r=a.data(),s=r.firstName,i=r.lastName,o=r.email,l=r.uid,e(H({firstName:s,lastName:i,email:o,uid:l}))):(e(D({type:"danger",message:"Your Account Terminated, So Please Register With New Email.."})),setTimeout((function(){return e(B())}),3e3),e(L(""))),t.next=11;break;case 8:e(D({type:"warning",message:"You Logged Out Please Login"})),setTimeout((function(){return e(B())}),3e3),e(L(""));case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}))}),[]),Object(c.jsx)("div",{className:"App",children:Object(c.jsxs)(l.a,{children:[Object(c.jsx)(u.b,{path:"/signin",component:q}),Object(c.jsx)(u.b,{path:"/signup",component:X}),Object(c.jsx)(Y,{exact:!0,path:"/",component:Q})]})})},ee=n(20),te=n(37),ne=n(38),ce={user:{},authenticated:!1,loadding:!1,userAlert:null},ae=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ce,t=arguments.length>1?arguments[1]:void 0,n=t.type,c=t.payload;switch(n){case C:return Object(z.a)(Object(z.a)({},e),{},{loadding:!0});case A:return Object(z.a)(Object(z.a)({},e),{},{user:c,loadding:!1,authenticated:!0});case R:case U:return Object(z.a)(Object(z.a)({},e),{},{user:{},loadding:!1,authenticated:!1});case F:return Object(z.a)(Object(z.a)({},e),{},{userAlert:c});case _:return Object(z.a)(Object(z.a)({},e),{},{userAlert:null});default:return e}},re={friends:[],conversation:[],loadding:!1,chatAlert:null},se=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re,t=arguments.length>1?arguments[1]:void 0,n=t.type,c=t.payload;switch(n){case b:return Object(z.a)(Object(z.a)({},e),{},{loadding:!0});case h:return Object(z.a)(Object(z.a)({},e),{},{friends:c,loadding:!1});case p:return Object(z.a)(Object(z.a)({},e),{},{friends:[],loadding:!1});case x:return Object(z.a)(Object(z.a)({},e),{},{loadding:!0,conversation:[]});case v:return Object(z.a)(Object(z.a)({},e),{},{conversation:c,loadding:!1});case O:return Object(z.a)(Object(z.a)({},e),{},{chatAlert:c});case g:return Object(z.a)(Object(z.a)({},e),{},{chatAlert:null});default:return e}},ie=Object(ee.combineReducers)({User:ae,Chat:se}),oe=Object(ee.createStore)(ie,Object(te.composeWithDevTools)(Object(ee.applyMiddleware)(ne.a)));i.a.render(Object(c.jsx)(r.a.StrictMode,{children:Object(c.jsx)(o.a,{store:oe,children:Object(c.jsx)($,{})})}),document.getElementById("root"))}},[[58,1,2]]]);
//# sourceMappingURL=main.2457f8bf.chunk.js.map