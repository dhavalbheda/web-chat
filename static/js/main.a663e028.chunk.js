(this["webpackJsonpweb-chat"]=this["webpackJsonpweb-chat"]||[]).push([[0],{102:function(e,t,n){},103:function(e,t,n){"use strict";n.r(t);var c=n(3),a=n(55),r=n(56),s=n(61),i=n(60),o=n(2),l=n.n(o),u=n(29),d=n.n(u),j=(n(68),n(11)),m=n(20),b=n(10),f=(n(72),n(17)),h=n(106),O=n(14),p=n.n(O),g=n(23),v="CHAT_FETCH_REQUEST",x="CHAT_FETCH_SUCCESS",N="CHAT_FETCH_ERROR",y="CHAT_SET_ALERT",w="CHAT_REMOVE_ALERT",E="REQUEST_CONVERSATION",S="SET_CONVERSATION",T="UPDATE_CONVERSATION",A=n(43);A.a.initializeApp({apiKey:"AIzaSyB3mUGEeVTQn7hbmoxUNncowRjwD-5y2TI",authDomain:"digital-jalebi-ac363.firebaseapp.com",databaseURL:"https://digital-jalebi-ac363-default-rtdb.firebaseio.com",projectId:"digital-jalebi-ac363",storageBucket:"digital-jalebi-ac363.appspot.com",messagingSenderId:"105427663157",appId:"1:105427663157:web:3e564360c7852fb4abb47c",measurementId:"G-M2DJG8HX1P"});var C=A.a,_=C.firestore(),R=C.database(),U=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return{type:E,payload:e}},F=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return{type:S,payload:e}},I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return{type:T,payload:e}},P=function(){var e=Object(g.a)(p.a.mark((function e(t){var n,c,a,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.uuid,c=t.sender,a=t.receiver,r=t.message,R.ref().child(c+"-"+a).push().set({uuid:n,sender:c,receiver:a,message:r,isSeen:!1,createdAt:C.database.ServerValue.TIMESTAMP});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),k=(n(76),"USER_FETCH_REQUEST"),H="USER_FETCH_SUCCESS",L="USER_FETCH_ERROR",D="USER_LOG_OUT",M="SET_ALERT",V="REMOVE_ALERT",B="TAB_CHANGE",W=C.firestore(),G=C.auth(),J=function(){return{type:k,payload:null}},Q=function(e){return{type:H,payload:e}},z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return{type:L,payload:e}},K=function(e){return{type:M,payload:e}},Y=function(e){return{type:V,payload:e}},Z=function(e,t){G.createUserWithEmailAndPassword(e.email,e.password).then((function(n){q(n,e,t)})).catch((function(e){t(K({type:"danger",message:e.message})),setTimeout((function(){return t(Y())}),3e3)}))},q=function(e,t,n){var c=t.firstName,a=t.lastName,r=t.email;G.currentUser.updateProfile({firstName:c,lastName:a}).then((function(){W.collection("users").doc(e.user.uid).set({firstName:c,lastName:a,email:r,uid:e.user.uid,isActive:!0,createdAt:new Date}).then((function(){localStorage.setItem("userId",e.user.uid),n(Q({firstName:c,lastName:a,email:r,uid:e.user.uid})),n(K({type:"success",message:"User Registerd Successfull"})),setTimeout((function(){return n(Y())}),3e3)}))})).catch((function(e){n(K({type:"danger",message:e.message})),setTimeout((function(){return n(Y())}),3e3)}))},X=function(e){return function(t){t(J()),W.collection("users").doc(e).update({isActive:!1}).then((function(){G.signOut().then((function(){t({type:D,payload:null}),t(K({type:"success",message:"Logout Successfully"})),setTimeout((function(){return t(Y())}),3e3)})).catch((function(e){t(K({type:"danger",message:e.message})),setTimeout((function(){return t(Y())}),3e3)}))})).catch((function(e){t(K({type:"danger",message:e.message})),setTimeout((function(){return t(Y())}),3e3)}))}},$=function(e){var t=Object(j.c)((function(e){return e.User})).user,n=Object(j.b)();return Object(c.jsxs)("header",{className:"header",children:[Object(c.jsx)("div",{style:{display:"flex"},children:Object(c.jsx)("div",{className:"logo",children:"Digital Jalebi"})}),Object(c.jsx)("div",{style:{margin:"20px 0px",color:"#fff",fontWeight:"bold"},children:"I'm "+t.firstName+" "+t.lastName}),Object(c.jsx)("ul",{className:"menu",children:Object(c.jsx)("li",{children:Object(c.jsx)(m.b,{to:"/signin",onClick:function(){n(X(t.uid))},children:"LogOut"})})})]})},ee=(n(78),n(79),function(e){var t=e.friends,n=e.selectFriend;return t.map((function(e,t){return Object(c.jsxs)("div",{className:"displayName",onClick:function(){return n(e)},children:[Object(c.jsx)("div",{className:"displayPic",children:Object(c.jsx)("img",{src:"https://i.pinimg.com/originals/86/63/78/866378ef5afbe8121b2bcd57aa4fb061.jpg",alt:""})}),Object(c.jsxs)("div",{style:{display:"flex",flex:1,justifyContent:"space-between",margin:"0 10px"},children:[Object(c.jsx)("span",{style:{fontWeight:500},children:e.firstName+" "+e.lastName}),Object(c.jsx)("span",{children:e.isActive?"Active":"offline"})]})]},t)}))}),te=function(e){var t=e.conversation,n=e.selectedFriend,a=e.user;return t.sort((function(e,t){return e.createdAt-t.createdAt})),t.map((function(e,t){var r=void 0;if(null!=e.createdAt){r=new Date(e.createdAt).toLocaleString("en",{day:"numeric",month:"short"}),r+=" "+new Date(e.createdAt).toLocaleTimeString([],{timeStyle:"short"})}return e.sender===n.uid&&e.receiver===a.uid||e.sender===a.uid&&e.receiver===n.uid?Object(c.jsx)("div",{style:{textAlign:e.sender===a.uid?"right":"left"},children:Object(c.jsxs)("p",{className:e.sender===a.uid?"messageStyle right-message":"messageStyle left-message",children:[e.message,Object(c.jsx)("br",{}),Object(c.jsx)("span",{className:"message-time",children:r||""}),e.receiver!==a.uid&&Object(c.jsx)("span",{className:"message-status",children:e.isSeen?Object(c.jsx)("i",{className:"far fa-eye"}):Object(c.jsx)("i",{className:"far fa-eye-slash"})})]})},t):Object(c.jsx)(o.Fragment,{},t)}))},ne=function(e){var t=Object(j.c)((function(e){return e.User})).user,n=Object(j.c)((function(e){return e.Chat})).conversation,a=Object(j.c)((function(e){return e.Chat})).friends,r=Object(o.useState)(!1),s=Object(f.a)(r,2),i=s[0],l=s[1],u=Object(o.useState)({}),d=Object(f.a)(u,2),m=d[0],b=d[1],O=Object(o.useState)(""),v=Object(f.a)(O,2),N=v[0],y=v[1],w=Object(j.b)();Object(o.useEffect)((function(){var e;w((e=t.uid,function(){var t=Object(g.a)(p.a.mark((function t(n){var c;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=_.collection("users").onSnapshot((function(t){var c=[];t.forEach((function(t){t.data().uid!==e&&c.push(t.data())})),n({type:x,payload:c})})),t.abrupt("return",c);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())).then((function(e){return e})).catch((function(e){return console.log(e)}))}),[]),Object(o.useEffect)((function(){return function(){return e=t.uid,n=m.uid,R.ref().child(e+"-"+n).off("child_added"),R.ref().child(e+"-"+n).off("child_changed"),void R.ref().child(n+"-"+e).off("child_added");var e,n}}),[m]);return Object(c.jsxs)(o.Fragment,{children:[Object(c.jsx)($,{}),Object(c.jsxs)("section",{className:"container-body",children:[Object(c.jsx)("div",{className:"listOfUsers",children:a.length>0&&Object(c.jsx)(ee,{selectFriend:function(e){m&&m.uid===e.uid||(l(!0),b(e),w(function(e){var t=e.sender,n=e.receiver;return function(){var e=Object(g.a)(p.a.mark((function e(c){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c(U()),R.ref().child(t+"-"+n).on("child_added",(function(e){c(F(e.val()))})),R.ref().child(n+"-"+t).on("child_added",(function(e){e.val().isSeen||R.ref().child(n+"-"+t).child(e.key).update({isSeen:!0}),c(F(e.val()))})),R.ref().child(t+"-"+n).on("child_changed",(function(e){c(I(e.val()))}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}({sender:t.uid,receiver:e.uid})))},friends:a})}),Object(c.jsxs)("div",{className:"chatArea",children:[Object(c.jsx)("div",{className:"chatHeader",children:i&&m.firstName+" "+m.lastName}),Object(c.jsx)("div",{className:"messageSections",children:i&&Object(c.jsx)(te,{conversation:n,selectedFriend:m,user:t})}),Object(c.jsx)("div",{className:"chatControls",children:i&&Object(c.jsxs)(o.Fragment,{children:[Object(c.jsx)("textarea",{placeholder:"Enter Text...",value:N,onChange:function(e){return y(e.target.value)}}),Object(c.jsx)("button",{onClick:function(){y("");var e={uuid:Object(h.a)(),sender:t.uid,receiver:m.uid,message:N};P(e)},children:"Send"})]})})]})]})]})},ce=n(5),ae=n(62),re=function(e){var t=e.Component,n=e.path,a=Object(ae.a)(e,["Component","path"]),r=Object(j.c)((function(e){return e.User})).authenticated;return Object(c.jsx)(o.Fragment,{children:r?Object(c.jsx)(b.b,Object(ce.a)(Object(ce.a)({exact:!0},a),{},{path:n,render:t})):Object(c.jsx)(b.a,{to:"/signin"})})},se=(n(101),n(102),function(e){var t=e.alert;return Object(c.jsx)(o.Fragment,{children:Object(c.jsx)("div",{className:"alert alert-".concat(t.type," alert-dismissible fade show mt-3"),style:{zIndex:1},role:"alert",children:Object(c.jsxs)("strong",{children:[t.message," !"]})})})}),ie=function(){var e=Object(j.c)((function(e){return e.User})),t=e.userAlert,n=e.authenticated,a=Object(o.useState)(""),r=Object(f.a)(a,2),s=r[0],i=r[1],l=Object(o.useState)(""),u=Object(f.a)(l,2),d=u[0],h=u[1],O=Object(j.b)(),v=function(e){var t;e.preventDefault(),O((t={email:s,password:d},function(){var e=Object(g.a)(p.a.mark((function e(n){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:""===t.email||t.password<6?(n(K({type:"warning",message:"Email is required!\n Password Must be more than 6 letter"})),setTimeout((function(){return n(Y())}),3e3)):(n(J()),G.signInWithEmailAndPassword(t.email,t.password).then((function(e){W.collection("users").doc(e.user.uid).update({isActive:!0}).then((function(){localStorage.setItem("userId",e.user.uid),n(K({type:"success",message:"Sign In Successfully"})),setTimeout((function(){return n(Y())}),3e3)})).catch((function(e){n(K({type:"danger",message:e.message})),setTimeout((function(){return n(Y())}),3e3)}))})).catch((function(e){n(K({type:"danger",message:e.message})),setTimeout((function(){return n(Y())}),3e3)})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()))};return Object(c.jsxs)("div",{className:"container",children:[t&&Object(c.jsx)(se,{alert:t}),n&&Object(c.jsx)(b.a,{to:"/"}),Object(c.jsx)("div",{className:"row justify-content-center justify-content-md-start",children:Object(c.jsx)("div",{className:"col-10 col-md-4 login-form ml-md-5 align-self-center",children:Object(c.jsxs)("form",{children:[Object(c.jsx)("div",{className:"form-group row",children:Object(c.jsx)("img",{alt:"signin",src:"https://media.giphy.com/media/kcZlnhiaB1p76tKS6S/giphy.gif"})}),Object(c.jsx)("div",{className:"form-group row",children:Object(c.jsx)("label",{htmlFor:"staticEmail",className:"col-sm-2 col-form-label align-self-start ml-md-5",children:"Email"})}),Object(c.jsx)("div",{className:"form-group row justify-content-center mb-4",children:Object(c.jsxs)("div",{className:"col-sm-10",children:[Object(c.jsx)("input",{type:"text",className:"form-control",id:"staticEmail",placeholder:"email@example.com",value:s,onChange:function(e){return i(e.target.value)}}),";"]})}),Object(c.jsx)("div",{className:"form-group row",children:Object(c.jsx)("label",{htmlFor:"inputPassword",className:"col-sm-2 col-form-label ml-md-5",children:"Password"})}),Object(c.jsx)("div",{className:"form-group row justify-content-center mb-4",children:Object(c.jsx)("div",{className:"col-sm-10",children:Object(c.jsx)("input",{type:"password",className:"form-control",id:"inputPassword",placeholder:"Password",value:d,onChange:function(e){return h(e.target.value)}})})}),Object(c.jsxs)("div",{className:"form-group row justify-content-center",children:[Object(c.jsx)("button",{className:"btn btn-primary m-2",onClick:function(e){return v(e)},children:"Sign In"}),Object(c.jsx)(m.c,{to:"/signup",className:"btn btn-primary m-2",children:"Sign Up"})]})]})})})]})},oe=function(){var e=Object(j.c)((function(e){return e.User})).userAlert,t=Object(o.useState)(""),n=Object(f.a)(t,2),a=n[0],r=n[1],s=Object(o.useState)(""),i=Object(f.a)(s,2),l=i[0],u=i[1],d=Object(o.useState)(""),b=Object(f.a)(d,2),h=b[0],O=b[1],p=Object(o.useState)(""),g=Object(f.a)(p,2),v=g[0],x=g[1],N=Object(o.useState)(""),y=Object(f.a)(N,2),w=y[0],E=y[1],S=Object(j.b)(),T=function(e){e.preventDefault(),S(function(e,t){return function(n){e.password!==t?(n(K({type:"danger",message:"Password and Confirm Password does not match"})),setTimeout((function(){return n(Y())}),3e3)):(n(J()),Z(e,n))}}({firstName:a,lastName:l,email:h,password:v},w))};return Object(c.jsxs)("div",{className:"container",children:[e&&Object(c.jsx)(se,{alert:e}),Object(c.jsx)("div",{className:"row justify-content-center justify-content-md-start",children:Object(c.jsx)("div",{className:"col-10 col-md-4 login-form ml-md-5 align-self-center",children:Object(c.jsxs)("form",{children:[Object(c.jsx)("div",{className:"form-group row",children:Object(c.jsx)("img",{alt:"signin",src:"https://media.giphy.com/media/kcZlnhiaB1p76tKS6S/giphy.gif"})}),Object(c.jsx)("div",{className:"form-group row",children:Object(c.jsx)("label",{htmlFor:"staticEmail",className:"col col-form-label align-self-start ml-md-5",children:"First Name"})}),Object(c.jsx)("div",{className:"form-group row justify-content-center mb-4",children:Object(c.jsx)("div",{className:"col-sm-10",children:Object(c.jsx)("input",{type:"text",className:"form-control",placeholder:"Enter First Name",value:a,onChange:function(e){return r(e.target.value)}})})}),Object(c.jsx)("div",{className:"form-group row",children:Object(c.jsx)("label",{htmlFor:"staticEmail",className:"col col-form-label align-self-start ml-md-5",children:"Last Name"})}),Object(c.jsx)("div",{className:"form-group row justify-content-center mb-4",children:Object(c.jsx)("div",{className:"col-sm-10",children:Object(c.jsx)("input",{type:"text",className:"form-control",placeholder:"Enter Last Name",value:l,onChange:function(e){return u(e.target.value)}})})}),Object(c.jsx)("div",{className:"form-group row",children:Object(c.jsx)("label",{htmlFor:"staticEmail",className:"col col-form-label align-self-start ml-md-5",children:"Email"})}),Object(c.jsx)("div",{className:"form-group row justify-content-center mb-4",children:Object(c.jsx)("div",{className:"col-sm-10",children:Object(c.jsx)("input",{type:"text",className:"form-control",placeholder:"Enter Email Id",value:h,onChange:function(e){return O(e.target.value)}})})}),Object(c.jsx)("div",{className:"form-group row",children:Object(c.jsx)("label",{htmlFor:"inputPassword",className:"col col-form-label ml-md-5",children:"Password"})}),Object(c.jsx)("div",{className:"form-group row justify-content-center mb-4",children:Object(c.jsx)("div",{className:"col-sm-10",children:Object(c.jsx)("input",{type:"password",className:"form-control",placeholder:"Enter Password",value:v,onChange:function(e){return x(e.target.value)}})})}),Object(c.jsx)("div",{className:"form-group row",children:Object(c.jsx)("label",{htmlFor:"inputPassword",className:"col col-form-label ml-md-5",children:"Confirm Password"})}),Object(c.jsx)("div",{className:"form-group row justify-content-center mb-4",children:Object(c.jsx)("div",{className:"col-sm-10",children:Object(c.jsx)("input",{type:"password",className:"form-control",placeholder:"Enter Confirm Password",value:w,onChange:function(e){return E(e.target.value)}})})}),Object(c.jsxs)("div",{className:"form-group row justify-content-center",children:[Object(c.jsx)("button",{className:"btn btn-primary m-2",onClick:function(e){return T(e)},children:"Sign Up"}),Object(c.jsx)(m.c,{to:"/signin",className:"btn btn-primary m-2",children:"I Have Account"})]})]})})})]})},le=function(){var e=Object(j.b)();return Object(o.useEffect)((function(){e((function(e){G.onAuthStateChanged(function(){var t=Object(g.a)(p.a.mark((function t(n){var c,a,r,s,i,o,l;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=8;break}return c=C.firestore().collection("users").doc(n.uid),t.next=4,c.get();case 4:(a=t.sent).exists?(r=a.data(),s=r.firstName,i=r.lastName,o=r.email,l=r.uid,e(Q({firstName:s,lastName:i,email:o,uid:l}))):(e(K({type:"danger",message:"Your Account Terminated, So Please Register With New Email.."})),setTimeout((function(){return e(Y())}),3e3),e(z(""))),t.next=11;break;case 8:e(K({type:"warning",message:"You Logged Out Please Login"})),setTimeout((function(){return e(Y())}),3e3),e(z(""));case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}))}),[e]),Object(c.jsx)("div",{className:"App",children:Object(c.jsxs)(m.a,{children:[Object(c.jsx)(b.b,{path:"/signin",component:ie}),Object(c.jsx)(b.b,{path:"/signup",component:oe}),Object(c.jsx)(re,{exact:!0,path:"/",component:ne})]})})},ue=n(22),de=n(58),je=n(59),me={user:{},authenticated:!1,currentTab:null,loadding:!1,userAlert:null},be=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:me,t=arguments.length>1?arguments[1]:void 0,n=t.type,c=t.payload;switch(n){case k:return Object(ce.a)(Object(ce.a)({},e),{},{loadding:!0});case H:return Object(ce.a)(Object(ce.a)({},e),{},{user:c,loadding:!1,authenticated:!0});case L:case D:return Object(ce.a)(Object(ce.a)({},e),{},{user:{},loadding:!1,authenticated:!1});case B:return Object(ce.a)(Object(ce.a)({},e),{},{currentTab:c});case M:return Object(ce.a)(Object(ce.a)({},e),{},{userAlert:c});case V:return Object(ce.a)(Object(ce.a)({},e),{},{userAlert:null});default:return e}},fe=n(44),he={friends:[],conversation:[],loadding:!1,chatAlert:null},Oe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:he,t=arguments.length>1?arguments[1]:void 0,n=t.type,c=t.payload;switch(n){case v:return Object(ce.a)(Object(ce.a)({},e),{},{loadding:!0});case x:return Object(ce.a)(Object(ce.a)({},e),{},{friends:c,loadding:!1});case N:return Object(ce.a)(Object(ce.a)({},e),{},{friends:[],loadding:!1});case E:return Object(ce.a)(Object(ce.a)({},e),{},{loadding:!0,conversation:[]});case S:return Object(ce.a)(Object(ce.a)({},e),{},{conversation:[].concat(Object(fe.a)(e.conversation),[c]),loadding:!1});case T:var a=e.conversation.filter((function(e){return e.uuid!==c.uuid}));return Object(ce.a)(Object(ce.a)({},e),{},{conversation:[].concat(Object(fe.a)(a),[c]),loadding:!1});case y:return Object(ce.a)(Object(ce.a)({},e),{},{chatAlert:c});case w:return Object(ce.a)(Object(ce.a)({},e),{},{chatAlert:null});default:return e}},pe=Object(ue.combineReducers)({User:be,Chat:Oe}),ge=Object(ue.createStore)(pe,Object(de.composeWithDevTools)(Object(ue.applyMiddleware)(je.a))),ve=function(e){Object(s.a)(n,e);var t=Object(i.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"componentDidMount",value:function(){window.addEventListener("beforeunload",(function(){return"show warning"}))}},{key:"render",value:function(){return Object(c.jsx)("div",{})}}]),n}(o.Component);d.a.render(Object(c.jsx)(l.a.StrictMode,{children:Object(c.jsxs)(j.a,{store:ge,children:[Object(c.jsx)(le,{}),Object(c.jsx)(ve,{})]})}),document.getElementById("root"))},68:function(e,t,n){},72:function(e,t,n){},76:function(e,t,n){},78:function(e,t,n){}},[[103,1,2]]]);
//# sourceMappingURL=main.a663e028.chunk.js.map